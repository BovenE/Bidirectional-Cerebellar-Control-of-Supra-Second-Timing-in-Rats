library(lme4)
library(lmerTest)
library(MuMIn)
library (ggplot2)
library (jtools)
library (broom)
library (broom.mixed)
library (ggstance)
library (huxtable)
library (performance)
library (see)
library(influence.ME)
library (olsrr)
library (sjPlot)
library (sjlabelled)
library(sjmisc)
library (glmmTMB)
library(multcomp)
library(margins)
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip3_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions3_dataset.csv'
dframe <- read.csv(path)
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip3_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions3_dataset.csv'
dframe <- read.csv(path)
my_data = dframe
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
#dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
dframe1["reward"][dframe1["reward"] == -1] <- 0
#Fixed effect models
Model1 = glm(reward~1, family=binomial, data=dframe1)
Model2 = glm(reward~group, family=binomial, data=dframe1)
Model1 = glm(reward~group*manipulation, family=binomial, data=dframe1)
anova(Model1, test="Chisq")
getwd()
model_poisson = Model1
conf_intervals <- confint(model_poisson, method = "profile")
# Visualization (Optional)
ggplot(df_summary, aes(x = manipulation, y = TOT_Trials, fill = group)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Number of Trials by Group and Drug Condition")
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip3_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions3_dataset.csv'
dframe <- read.csv(path)
#reduce dataset
dframe_sub <- subset(dframe, t_hold<=(450/100) & t_hold>(20/100) & reward>-1)
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
#dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
#plot interaction
interaction.plot(x.factor = my_data$group, trace.factor = my_data$manipulation,
response = my_data$t_hold , fun = mean,
type = "b", legend = TRUE,
xlab = "group", ylab="Exit time (cs)",
pch=c(1,19))
#Model1 = lmer(t_hold~group*manipulation+(1|rat), data=dframe1,REML = FALSE)
#Model3 = lmer(t_hold~group*manipulation+(1|Session_date), data=dframe1,REML = FALSE)
#Model4 = lmer(t_hold~group*manipulation+(1|rat)+(1|Session_date), data=dframe1,REML = FALSE)
Model5 = lmer(t_hold~group*manipulation+(1|Session_date)+(1|rat)+(1|trials_norm), data=dframe1,REML = FALSE)
summary(Model5)
ggpredict(Model5, c("group", "manipulation"))%>% plot()
model_poisson = Model5
conf_intervals <- confint(model_poisson, method = "profile")
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
getwd()
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip3_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions3_dataset.csv'
dframe <- read.csv(path)
#reduce dataset
#dframe_sub <- subset(dframe, t_hold<=(350) & t_hold>(20) & reward>-1)
dframe_sub <- subset(dframe, reward_lat>0)
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
#dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
Model1 = lmer(reward_lat~group*manipulation+(1|Session_date)+(1|rat), data=dframe1)
summary(Model1)
confint(Model1)
anova(Model1)
model_poisson = Model1
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip4_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions4_dataset.csv'
dframe <- read.csv(path)
my_data = dframe
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
#dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
dframe1["reward"][dframe1["reward"] == -1] <- 0
Model1 = glm(reward~1, family=binomial, data=dframe1)
Model2 = glm(reward~group, family=binomial, data=dframe1)
Model3 = glm(reward~group+manipulation, family=binomial, data=dframe1)
Model4 = glm(reward~group*manipulation, family=binomial, data=dframe1)
Model1 = glm(reward~group*manipulation, family=binomial, data=dframe1)
anova(Model1, test="Chisq")
summary(Model1)
idx=3#2
((exp(coefficients(Model1)[1]+coefficients(Model1)[idx])/(1+exp(coefficients(Model1)[1]+coefficients(Model1)[idx])))-(exp(coefficients(Model1)[1])/(1+exp(coefficients(Model1)[1]))))*100
confint(Model1)
((exp(confint(Model1)[1]+confint(Model1)[idx])/(1+exp(confint(Model1)[1]+confint(Model1)[idx])))-(exp(confint(Model1)[1])/(1+exp(confint(Model1)[1]))))*100
((exp(confint(Model1)[1]+confint(Model1)[idx+4])/(1+exp(confint(Model1)[1]+confint(Model1)[idx+4])))-(exp(confint(Model1)[1])/(1+exp(confint(Model1)[1]))))*100
model_poisson= Model1
summary(model_poisson)
anova(model_poisson)
summary(model_poisson)
conf_intervals <- confint(model_poisson, method = "profile")
conf_intervals <- confint(model_poisson, method = "profile")
conf_intervals
summary(model_poisson)
exp(-0.19436)
exp(0.25829)
conf_int
conf_intervals
model_poisson= Model1
summary(model_poisson)
anova(model_poisson)
summary(model_poisson)
conf_intervals <- confint(model_poisson, method = "profile")
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
getwd()
#load data
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip4_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions4_dataset.csv'
dframe <- read.csv(path)
#reduce dataset to have normal distribution (closer)
dframe_sub <- subset(dframe, reward>-1 & t_hold<=(450/100) & t_hold>(0/100) & reward>-1)# & trial==2)# & rat != 'TITET_19'& rat != 'TITET_20') #& trial==1) %
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
#plot interaction
interaction.plot(x.factor = my_data$group, trace.factor = my_data$manipulation,
response = my_data$t_hold , fun = mean,
type = "b", legend = TRUE,
xlab = "group", ylab="Exit time (cs)",
pch=c(1,19))
#
Model1 = lmer(t_hold~group*manipulation+(1|rat), data=dframe1,REML = FALSE)
#Model3 = lmer(t_hold~group*manipulation+(1|Session_date), data=dframe1,REML = FALSE)
#Model4 = lmer(t_hold~group*manipulation+(1|rat)+(1|Session_date), data=dframe1,REML = FALSE)
Model5 = lmer(t_hold~group*manipulation+(1|Session_date)+(1|rat), data=dframe1,REML = FALSE)
summary(Model5)
confint(Model5)
ggpredict(Model1, c("group", "manipulation"))%>% plot()
anova(Model5)
model_poisson = Model5
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
anova_results <- capture.output(anova(model_poisson))
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip4_dataset_NEWFINAL.csv'
dframe <- read.csv(path)
#reduce dataset
#dframe_sub <- subset(dframe, t_hold<=(350) & t_hold>(20) & reward>-1)
dframe_sub <- subset(dframe, reward_lat>0)
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
#dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
Model1 = lmer(reward_lat~group*manipulation+(1|Session_date)+(1|rat), data=dframe1)
summary(Model1)
confint(Model1)
anova(Model1)
Model1 = lmer(reward_lat~group*manipulation+(1|Session_date)+(1|rat), data=dframe1)
summary(Model1)
confint(Model1)
anova(Model1)
model_poisson = Model1
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
dframe <- read.csv(path)
#reduce dataset to have normal distribution (closer)
dframe_sub <- subset(dframe, reward>-1 & t_hold<=(450/100) & t_hold>(0/100) & reward>-1 & trial==1)# & rat != 'TITET_19'& rat != 'TITET_20') #& trial==1) %
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
#plot interaction
interaction.plot(x.factor = my_data$group, trace.factor = my_data$manipulation,
response = my_data$t_hold , fun = mean,
type = "b", legend = TRUE,
xlab = "group", ylab="Exit time (cs)",
pch=c(1,19))
#
Model1 = lmer(t_hold~group*manipulation+(1|rat), data=dframe1,REML = FALSE)
#Model3 = lmer(t_hold~group*manipulation+(1|Session_date), data=dframe1,REML = FALSE)
#Model4 = lmer(t_hold~group*manipulation+(1|rat)+(1|Session_date), data=dframe1,REML = FALSE)
Model5 = lmer(t_hold~group*manipulation+(1|Session_date)+(1|rat), data=dframe1,REML = FALSE)
summary(Model5)
confint(Model5)
anova(Model5)
model_poisson = Model5
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/ip4_dataset_NEWFINAL.csv'
#path ='/Users/va18024/Library/CloudStorage/OneDrive-UniversityofBristol/Documents/PhD/Cerebellearning/Experimental/Analysis/EB_Analysis/R_scripts/GLM/infusions4_dataset.csv'
dframe <- read.csv(path)
#reduce dataset to have normal distribution (closer)
dframe_sub <- subset(dframe, reward>-1 & t_hold<=(450/100) & t_hold>(20/100) & reward>-1 & trial==2)# & rat != 'TITET_19'& rat != 'TITET_20') #& trial==1) %
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
#plot interaction
interaction.plot(x.factor = my_data$group, trace.factor = my_data$manipulation,
response = my_data$t_hold , fun = mean,
type = "b", legend = TRUE,
xlab = "group", ylab="Exit time (cs)",
pch=c(1,19))
#
Model1 = lmer(t_hold~group*manipulation+(1|rat), data=dframe1,REML = FALSE)
#Model3 = lmer(t_hold~group*manipulation+(1|Session_date), data=dframe1,REML = FALSE)
#Model4 = lmer(t_hold~group*manipulation+(1|rat)+(1|Session_date), data=dframe1,REML = FALSE)
Model5 = lmer(t_hold~group*manipulation+(1|Session_date)+(1|rat), data=dframe1,REML = FALSE)
summary(Model5)
confint(Model5)
anova(Model5)
model_poisson = Model5
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
# If you want to capture ANOVA results for the model
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
dframe_sub <- subset(dframe, reward>-1 & t_hold<=(450/100) & t_hold>(20/100) & reward>-1 & trial==1)# & rat != 'TITET_19'& rat != 'TITET_20') #& trial==1) %
my_data = dframe_sub
dframe1=my_data
dframe1$group <- as.factor(dframe1$group)
dframe1$manipulation <- as.factor(dframe1$manipulation)
dframe1$manipulation <- factor(dframe1$manipulation, levels = levels(dframe1$manipulation)[2:1])
dframe1$sensory_state <- as.factor(dframe1$sensory_state)
dframe1$trial <- as.factor(dframe1$trial)
dframe1$Session_date=as.character(dframe1$Session_date)
dframe1$Session_date <- as.Date(dframe1$Session_date, '%Y%m%d')
#dframe1$reward <- as.factor(dframe1$reward)
dframe1$rat <- as.factor(dframe1$rat)
#plot interaction
interaction.plot(x.factor = my_data$group, trace.factor = my_data$manipulation,
response = my_data$t_hold , fun = mean,
type = "b", legend = TRUE,
xlab = "group", ylab="Exit time (cs)",
pch=c(1,19))
#
Model1 = lmer(t_hold~group*manipulation+(1|rat), data=dframe1,REML = FALSE)
#Model3 = lmer(t_hold~group*manipulation+(1|Session_date), data=dframe1,REML = FALSE)
#Model4 = lmer(t_hold~group*manipulation+(1|rat)+(1|Session_date), data=dframe1,REML = FALSE)
Model5 = lmer(t_hold~group*manipulation+(1|Session_date)+(1|rat), data=dframe1,REML = FALSE)
summary(Model5)
confint(Model5)
anova(Model5)
model_poisson = Model5
# Capture the summary output
model_summary <- capture.output(summary(model_poisson))
# Optional: Save the model summary to a text file (Basic Output)
writeLines(model_summary, "model_summary.txt")
# For a more detailed output (like confidence intervals, p-values):
# Capture the confidence intervals for the fixed effects
conf_intervals <- capture.output(confint(model_poisson, method = "profile"))
# Combine the output (model summary + confidence intervals) into one object
full_output <- c(model_summary, "Confidence Intervals:", conf_intervals)
# Write the full output to a text file
writeLines(full_output, "detailed_model_summary.txt")
anova_results <- capture.output(anova(model_poisson))
writeLines(anova_results, "anova_results.txt")
